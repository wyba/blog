(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{507:function(t,s,a){"use strict";a.r(s);var n=a(21),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("blockquote",[a("p",[t._v("基础乃重中之重")])]),t._v(" "),a("h2",{attrs:{id:"_1-简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-简介"}},[t._v("#")]),t._v(" 1. 简介")]),t._v(" "),a("ul",[a("li",[t._v("BroadcastReceiver （广播接收器），属于Android四大组件之一")]),t._v(" "),a("li",[t._v("Android 广播分为两个角色：广播发送者、广播接收者")]),t._v(" "),a("li",[t._v("用于监听 / 接收 应用发出的广播消息，并做出响应")])]),t._v(" "),a("p",[a("strong",[t._v("应用场景")]),t._v("：")]),t._v(" "),a("ul",[a("li",[t._v("不同组件之间通信（包括应用内 / 不同应用之间）")]),t._v(" "),a("li",[t._v("与 Android 系统在特定情况下的通信，如当电话呼入时、网络可用时")]),t._v(" "),a("li",[t._v("多线程通信")])]),t._v(" "),a("p",[a("strong",[t._v("实现原理")]),t._v("：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/wyba/image_store/blog/20210527173928554.png",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("使用了设计模式中的观察者模式：基于消息的发布/订阅事件模型。")]),t._v(" "),a("p",[t._v("有3个角色：")]),t._v(" "),a("ol",[a("li",[t._v("消息订阅者（广播接收者）")]),t._v(" "),a("li",[t._v("消息发布者（广播发布者）")]),t._v(" "),a("li",[t._v("消息中心（ AMS ，即 Activity Manager Service ）")])]),t._v(" "),a("p",[t._v("过程描述：")]),t._v(" "),a("p",[t._v("广播接收者 通过 Binder 机制在 AMS 注册")]),t._v(" "),a("p",[t._v("广播发送者 通过 Binder 机制向 AMS 发送广播")]),t._v(" "),a("p",[t._v("AMS 根据 广播发送者 要求，在已注册列表中，寻找合适的广播接收者")]),t._v(" "),a("p",[t._v("寻找依据： IntentFilter / Permission")]),t._v(" "),a("p",[t._v("AMS 将广播发送到合适的广播接收者相应的消息循环队列中；")]),t._v(" "),a("p",[t._v("广播接收者通过 消息循环 拿到此广播，并回调 onReceive()")]),t._v(" "),a("p",[a("strong",[t._v("注意")]),t._v("：广播发送者和广播接收者的执行是异步的，发出去的广播不会关心有无接收者接收，也不确定接收者到底是何时才能接收到；")]),t._v(" "),a("h2",{attrs:{id:"_2-广播注册"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-广播注册"}},[t._v("#")]),t._v(" 2. 广播注册")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/wyba/image_store/blog/20210527174215487.png",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[a("strong",[t._v("注意")]),t._v("：")]),t._v(" "),a("p",[t._v("动态广播最好在Activity的onResume()注册、onPause()注销。")]),t._v(" "),a("p",[t._v("对于动态广播，有注册就必然得有注销，否则会导致内存泄露重复注册、重复注销也不允许")]),t._v(" "),a("h3",{attrs:{id:"_1-静态注册"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-静态注册"}},[t._v("#")]),t._v(" （1） 静态注册")]),t._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[t._v('<receiver\n\t//此广播接收者类是mBroadcastReceiver\n\tandroid:name=".mBroadcastReceiver" >\n\t//用于接收网络状态改变时发出的广播\n\t'),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("intent-filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("action")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("android:")]),t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("android.net.conn.CONNECTIVITY_CHANGE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("intent-filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("receiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("h3",{attrs:{id:"_2-动态注册"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-动态注册"}},[t._v("#")]),t._v(" （2） 动态注册")]),t._v(" "),a("p",[t._v("在代码中通过调用Context的registerReceiver（）方法进行动态注册BroadcastReceiver，具体代码如下：")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onResume")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onResume")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//实例化BroadcastReceiver子类 & IntentFilter")]),t._v("\n\tmBroadcastReceiver mBroadcastReceiver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mBroadcastReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntentFilter")]),t._v(" intentFilter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntentFilter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置接收广播的类型")]),t._v("\n\tintentFilter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CONNECTIVITY_CHANGE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//调用Context的registerReceiver（）方法进行动态注册")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mBroadcastReceiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" intentFilter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注册广播后，要在相应位置记得销毁广播")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//即在onPause() 中unregisterReceiver(mBroadcastReceiver)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//当此Activity实例化时，会动态将MyBroadcastReceiver注册到系统中")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//当此Activity销毁时，动态注册的MyBroadcastReceiver将不再接收到相应的广播。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onPause")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onPause")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//销毁在onResume()方法中的广播")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("unregisterReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mBroadcastReceiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br")])]),a("h2",{attrs:{id:"_3-广播类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-广播类型"}},[t._v("#")]),t._v(" 3.广播类型")]),t._v(" "),a("ul",[a("li",[t._v("普通广播（Normal Broadcast）")]),t._v(" "),a("li",[t._v("系统广播（System Broadcast）")]),t._v(" "),a("li",[t._v("有序广播（Ordered Broadcast）")]),t._v(" "),a("li",[t._v("粘性广播（Sticky Broadcast）")]),t._v(" "),a("li",[t._v("App应用内广播（Local Broadcast）")])]),t._v(" "),a("h3",{attrs:{id:"_1-普通广播-normal-broadcast"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-普通广播-normal-broadcast"}},[t._v("#")]),t._v(" （1）普通广播（Normal Broadcast）")]),t._v(" "),a("p",[t._v("即开发者自身定义intent的广播（最常用）")]),t._v(" "),a("h3",{attrs:{id:"_2-系统广播-system-broadcast"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-系统广播-system-broadcast"}},[t._v("#")]),t._v(" （2）系统广播（System Broadcast）")]),t._v(" "),a("p",[t._v("Android中内置了多个系统广播：只要涉及到手机的基本操作（如开机、网络状态变化、拍照等等），都会发出相应的广播")]),t._v(" "),a("p",[t._v("每个广播都有特定的Intent - Filter（包括具体的action），Android系统广播action如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/wyba/image_store/blog/20210527175121954.png",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[a("strong",[t._v("注意")]),t._v("：当使用系统广播时，只需要在注册广播接收者时定义相关的action即可，并不需要手动发送广播，当系统有相关操作时会自动进行系统广播")]),t._v(" "),a("h3",{attrs:{id:"_3-有序广播-ordered-broadcast"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-有序广播-ordered-broadcast"}},[t._v("#")]),t._v(" （3）有序广播（Ordered Broadcast）")]),t._v(" "),a("p",[t._v("发送出去的广播被广播接收者按照先后顺序接收.,有序是针对广播接收者而言的")]),t._v(" "),a("p",[t._v("按照Priority属性值从大-小排序,Priority属性相同者，动态注册的广播优先；")]),t._v(" "),a("p",[t._v("接收广播按顺序接收,先接收的广播接收者可以对广播进行截断，即后接收的广播接收者不再接收到此广播,先接收的广播接收者可以对广播进行修改，那么后接收的广播接收者将接收到被修改后的广播")]),t._v(" "),a("h3",{attrs:{id:"_4-app应用内广播-local-broadcast"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-app应用内广播-local-broadcast"}},[t._v("#")]),t._v(" （4）App应用内广播（Local Broadcast）")]),t._v(" "),a("ul",[a("li",[t._v("Android中的广播可以跨App直接通信（exported对于有intent-filter情况下默认值为true）")]),t._v(" "),a("li",[t._v("App应用内广播可理解为一种局部广播，广播的发送者和接收者都同属于一个App。")]),t._v(" "),a("li",[t._v("相比于全局广播（普通广播），App应用内广播优势体现在：安全性高 & 效率高")])]),t._v(" "),a("p",[a("strong",[t._v("具体使用1 - 将全局广播设置成局部广播")]),t._v(":")]),t._v(" "),a("ul",[a("li",[t._v("注册广播时将exported属性设置为_false_，使得非本App内部发出的此广播不被接收；")]),t._v(" "),a("li",[t._v("在广播发送和接收时，增设相应权限permission，用于权限验证；")]),t._v(" "),a("li",[t._v("发送广播时指定该广播接收器所在的包名，此广播将只会发送到此包中的App内与之相匹配的有效广播接收器中。")])]),t._v(" "),a("p",[a("strong",[t._v("具体使用2 - 使用封装好的LocalBroadcastManager类")]),t._v("：")]),t._v(" "),a("p",[t._v("使用方式上与全局广播几乎相同，只是注册/取消注册广播接收器和发送广播时将参数的context变成了LocalBroadcastManager的单一实例")]),t._v(" "),a("p",[t._v("注：对于LocalBroadcastManager方式发送的应用内广播，只能通过LocalBroadcastManager动态注册，不能静态注册")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注册应用内广播接收器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//步骤1：实例化BroadcastReceiver子类 & IntentFilter mBroadcastReceiver ")]),t._v("\nmBroadcastReceiver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mBroadcastReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntentFilter")]),t._v(" intentFilter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntentFilter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//步骤2：实例化LocalBroadcastManager的实例")]),t._v("\nlocalBroadcastManager "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalBroadcastManager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//步骤3：设置接收广播的类型 ")]),t._v("\nintentFilter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CONNECTIVITY_CHANGE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//步骤4：调用LocalBroadcastManager单一实例的registerReceiver（）方法进行动态注册 ")]),t._v("\nlocalBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mBroadcastReceiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" intentFilter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//取消注册应用内广播接收器")]),t._v("\nlocalBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("unregisterReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mBroadcastReceiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//发送应用内广播")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),t._v(" intent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nintent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BROADCAST_ACTION"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlocalBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendBroadcast")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br")])]),a("h3",{attrs:{id:"_5-粘性广播-sticky-broadcast"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-粘性广播-sticky-broadcast"}},[t._v("#")]),t._v(" （5）粘性广播（Sticky Broadcast）")]),t._v(" "),a("p",[t._v("由于在Android5.0 & API 21中已经失效，所以不建议使用，在这里也不作过多的总结。")])])}),[],!1,null,null,null);s.default=e.exports}}]);